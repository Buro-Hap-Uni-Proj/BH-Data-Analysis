---
title: "BH Analysis"
author: "Marc"
date: "28/02/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

Required Libraries:
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
```

Getting File:
```{r}
#Depending on Computer:
#setwd('/users/marckennedy/desktop')
getwd()
setwd('/Users/Marc/Desktop')
BHData<-read.csv(file='BHDATA.csv')
#BHData
```

Converting Time:
```{r}
BHData$datetime<-as.POSIXct((BHData$time)/1000, origin="1970-01-01")
```

Separating Position:
```{r}
BHData$datetime<-as.POSIXct((BHData$time)/1000, origin="1970-01-01")
BH<- data.frame(separate(BHData,position, c("X", "Y"),","))
BH$X2<-as.numeric(gsub("\\[","",BH$X))
BH$Y2<-as.numeric(gsub("\\]","",BH$Y))
```

Tidying Up Data:
```{r}
BH$uuid<-NULL
BH$direction<-NULL
BH$X<- BH$X2
BH$Y<- BH$Y2
BH$X2<- NULL
BH$Y2<- NULL
BH$position<- BHData$position
```


Test plot (position over time):
```{r}
ggplot(data = BH, aes(x= -Y,y=-X,color= datetime)) + geom_point()
```
Test Data (1000 rows):
```{r}
BHT<-subset(BH, BH$id<4134925)
BHT$irlynx_id<-as.character(BHT$irlynx_id)
str(BHT)
```

Journey Time
```{r}

max<-data.frame(tapply(BHT$datetime,BHT$irlynx_id,max))
min<-data.frame(tapply(BHT$datetime,BHT$irlynx_id,min))
jt<-merge(max,min,by ="row.names")
jt$journeytime<-(jt$tapply.BHT.datetime..BHT.irlynx_id..max.-jt$tapply.BHT.datetime..BHT.irlynx_id..min.)
sum(jt$journeytime)/3600
max(jt$journeytime)/3600
jtest<-subset(jt,jt$journeytime==max(jt$journeytime))
test<-subset(BH,BH$irlynx_id=="436d2c08-c27b-4519-8217-cfa0474a11b7")

```


